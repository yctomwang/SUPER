fsm:
  click_goal_en: true
  click_goal_topic: "/planning/click_goal"
  click_height: -100   # Disabled: use Z from waypoints
  click_yaw_en: true
  replan_rate: 2.0
  cmd_topic: "/planning/pos_cmd"
  mpc_cmd_topic: "/planning_cmd/poly_traj"
  timer_en: true

super_planner:
  backup_traj_en: true
  detailed_log_en: false
  visualization_en: true
  use_fov_cut: false
  print_log: false
  visual_process: false
  frontend_in_known_free: false  # Allow planning through unknown space (stope interior starts unknown)
  goal_yaw_en: false
  goal_vel_en: false

  corridor_bound_dis: 3.0
  corridor_line_max_length: 8.0
  safe_corridor_line_max_length: 999

  iris_iter_num: 5
  obs_skip_num: 1
  replan_forward_dt: 0.1
  planning_horizon: 25.0
  sensing_horizon: -1
  receding_dis: 12.0
  robot_r: 0.3
  yaw_dot_max: 1.0
  yaw_mode: 1
  mpc_horizon: 15

traj_opt:
  switch:
    save_log_en: false
    print_optimizer_log: false

  boundary:
    max_vel: 2.0
    max_acc: 2.0
    max_jerk: 15.0
    max_omg: 2.5
    max_acc_thr: 17.0
    min_acc_thr: 6.0
    penna_margin: 0.05

  exp_traj:
    pos_constraint_type: 1
    energy_cost_type: 4
    block_energy_cost: false
    opt_accuracy: 5.0e-6
    scale_factor: 1.0
    integral_reso: 15
    smooth_eps: 0.01
    penna_t: 1.0e+7
    penna_pos: 5.0e+9
    penna_vel: 5.0e+8
    penna_acc: 5.0e+8
    penna_jerk: -5.0e+8
    penna_attract: 5.0e+8
    penna_omg: -1
    penna_thr: -1

  backup_traj:
    uniform_time_en: true
    pos_constraint_type: 2
    piece_num: 2
    energy_cost_type: 4
    block_energy_cost: true
    opt_accuracy: 1.0e-5
    scale_factor: 1.0
    integral_reso: 12
    smooth_eps: 0.01
    penna_t: 100.0
    penna_ts: 1.0e+7
    penna_pos: 1.0e+10
    penna_vel: 1.0e+8
    penna_acc: 1.0e+8
    penna_jerk: -1.0e+6
    penna_omg: -1
    penna_thr: -1

  flatness:
    mass: 1.64
    dh: 0.35
    dv: 0.35
    cp: 0.001
    v_eps: 0.0001
    grav: 9.81

astar:
  map_voxel_num: [ 500, 800, 400 ]
  visual_process: false
  allow_diag: true
  heu_type: 2
  debug_visualization_en: false

rog_map:
  resolution: 0.3
  inflation_resolution: 0.3
  inflation_step: 3              # 3 steps * 0.3m = 0.9m safety buffer around walls
  unk_inflation_en: false
  unk_inflation_step: 1
  map_size: [ 90, 170, 80 ]
  fix_map_origin: [ 0, 0, 34 ]
  frontier_extraction_en: false
  virtual_ceil_height: 70
  virtual_ground_height: -1.0

  # Load the real stope PCD directly as static obstacles
  load_pcd_en: true
  pcd_name: "${CMAKE_ROOT_DIR}/../mars_uav_sim/perfect_drone_sim/pcd/real_stope.pcd"

  map_sliding:
    enable: false
    threshold: 0.3
  esdf:
    enable: false
    resolution: 0.1
    local_update_box: [ 5,5,3 ]
  ros_callback:
    enable: true
    cloud_topic: "/cloud_registered"
    odom_topic: "/lidar_slam/odom"
    odom_timeout: 2.0
  visualization:
    enable: true
    use_dynamic_reconfigure: false
    time_rate: 2
    frame_rate: 0
    range: [ 50, 80, 40 ]
    frame_id: "world"
    pub_unknown_map_en: false
  intensity_thresh: -10
  point_filt_num: 1

  raycasting:
    enable: true
    batch_update_size: 1
    local_update_box: [ 50, 80, 40 ]
    ray_range: [0.5, 60.0 ]
    p_min: 0.12
    p_miss: 0.4999             # Almost neutral â€” walls barely erode from miss events
    p_free: 0.4999
    p_occ: 0.85
    p_hit: 0.99               # Strong occupied reinforcement from LiDAR hits
    p_max: 0.999              # Higher ceiling so loaded walls are very resistant
    unk_thresh: 1.0
